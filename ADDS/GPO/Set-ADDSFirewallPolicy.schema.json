{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$comment": "Schema file for the Set-ADDSFirewallPolicy.json config.",
    "title": "Domain Controller Firewall Configuration",
    "type": "object",
    "properties": {
      "GroupPolicyObjectName": {
        "type": "string",
        "default": "Domain Controller Firewall",
        "description": "The name of the Group Policy Object (GPO) that will be created or updated."
      },
      "GroupPolicyObjectComment": {
        "type": "string",
        "default": "This GPO is managed by the Set-ADDSFirewallPolicy.ps1 PowerShell script.",
        "description": "The comment that will be added to the Group Policy Object (GPO)."
      },
      "EnforceOutboundRules": {
        "type": "boolean",
        "default": false,
        "description": "Indicates whether the outbound traffic should be blocked by default."
      },
      "LogDroppedPackets": {
        "type": "boolean",
        "default": false,
        "description": "Indicates whether the packets dropped by the firewall should be logged."
      },
      "LogFilePath": {
        "type": "string",
        "default": "%systemroot%\\system32\\logfiles\firewall\\pfirewall.log",
        "description": "The path to the log file that will be used to store information about the dropped packets."
      },
      "LogMaxSizeKilobytes": {
        "type": "integer",
        "minimum": 1,
        "maximum": 32767,
        "default": 32767,
        "description": ""
      },
      "ClientAddresses": {
        "oneOf": [
          {
            "type": "array",
            "items": {
              "anyOf": [
                {
                  "type": "string",
                  "examples": [
                    "10.220.1.0/24",
                    "10.220.2.100-10.220.2.150",
                    "2001:db8:abcd:0012::0/64"
                  ]
                },
                {
                  "enum": [
                    "LocalSubnet",
                    "DNS",
                    "DHCP",
                    "WINS",
                    "DefaultGateway",
                    "Internet",
                    "Intranet",
                    "IntranetRemoteAccess",
                    "PlayToDevice",
                    "CaptivePortal"
                  ]
                }
              ],
              "minLength": 1,
              "uniqueItems": true
            }
          },
          {
            "type": "array",
            "items": {
              "const": "Any",
              "minLength": 1,
              "maxLength": 1
            }
          }
        ],
        "default": [ "Any" ],
        "description": ""
      },
      "ManagementAddresses": {
        "oneOf": [
          {
            "type": "array",
            "items": {
              "anyOf": [
                {
                  "type": "string",
                  "examples": [
                    "10.220.1.0/24",
                    "10.220.2.100-10.220.2.150",
                    "2001:db8:abcd:0012::0/64"
                  ]
                },
                {
                  "enum": [
                    "LocalSubnet",
                    "DNS",
                    "DHCP",
                    "WINS",
                    "DefaultGateway",
                    "Internet",
                    "Intranet",
                    "IntranetRemoteAccess",
                    "PlayToDevice",
                    "CaptivePortal"
                  ]
                }
              ],
              "minLength": 1,
              "uniqueItems": true
            }
          },
          {
            "type": "array",
            "items": {
              "const": "Any",
              "minLength": 1,
              "maxLength": 1
            }
          }
        ],
        "default": [ "Any" ],
        "description": ""
      },
      "DomainControllerAddresses": {
        "oneOf": [
          {
            "type": "array",
            "items": {
              "anyOf": [
                {
                  "type": "string",
                  "examples": [
                    "10.220.1.0/24",
                    "10.220.2.100-10.220.2.150",
                    "2001:db8:abcd:0012::0/64"
                  ]
                },
                {
                  "enum": [
                    "LocalSubnet",
                    "DNS",
                    "DHCP",
                    "WINS",
                    "DefaultGateway",
                    "Internet",
                    "Intranet",
                    "IntranetRemoteAccess",
                    "PlayToDevice",
                    "CaptivePortal"
                  ]
                }
              ],
              "minLength": 1,
              "uniqueItems": true
            }
          },
          {
            "type": "array",
            "items": {
              "const": "Any",
              "minLength": 1,
              "maxLength": 1
            }
          }
        ],
        "default": [ "Any" ],
        "description": ""
      },
      "NtdsStaticPort": {
        "oneOf": [
          {
            "type": "integer",
            "minimum": 1024,
            "maximum": 49151
          },
          {
            "const": 0
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": ""
      },
      "NetlogonStaticPort": {
        "oneOf": [
          {
            "type": "integer",
            "minimum": 1024,
            "maximum": 49151
          },
          {
            "const": 0
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": ""
      },
      "DfsrStaticPort": {
        "oneOf": [
          {
            "type": "integer",
            "minimum": 1024,
            "maximum": 49151
          },
          {
            "const": 0
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": ""
      },
      "WmiStaticPort": {
        "anyOf": [
          {
            "type": "boolean"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": ""
      },
      "DisableLLMNR": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "DisableMDNS": {
        "anyOf": [
          {
            "type": "boolean"
          },
          {
            "type": "null"
          }
        ],
        "default": null,
        "description": ""
      },
      "EnableServiceManagement": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableEventLogManagement": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableScheduledTaskManagement": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableWindowsRemoteManagement": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnablePerformanceLogAccess": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableOpenSSHServer": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableRemoteDesktop": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableDiskManagement": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableBackupManagement": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableFirewallManagement": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableComPlusManagement": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableLegacyFileReplication": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableNetbiosNameService": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableNetbiosDatagramService": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableNetbiosSessionService": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableWINS": {
        "type": "boolean",
        "default": true,
        "description": ""
      },
      "EnableNetworkProtection": {
        "type": "boolean",
        "default": false,
        "description": ""
      },
      "EnableInternetTraffic": {
        "type": "boolean",
        "default": true,
        "description": ""
      }
    },
    "required": ["GroupPolicyObjectName"]
  }